(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bc172820"],{"1e7f":function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return b}));var n=i("5530"),o=i("d4ec"),s=i("bee2"),a=i("262e"),r=i("2caf"),u=i("b6c9"),l=function(){var t=this,e=t._self._c;return e("div",t._l(t.data,(function(i){return e("div",{key:i.userId,staticClass:"student-item",style:{left:t.diffInfo.w+t.pptratio.width*i.originXRatio+"px",top:t.diffInfo.h+t.pptratio.height*i.originYRatio+"px",width:t.pptratio.width*i.WRatio+"px",height:t.pptratio.height*i.HRatio+"px"}},[e("p",{staticClass:"stu-name word-ellipsis"},[t._v(" "+t._s(i.nickName)+" ")]),e("p",{staticClass:"stu-img"},[e("img",{attrs:{src:i.avatar,alt:""}})]),4===t.msgType&&t.urlMap[i.addCoin]&&t.isShowCoins?e("lottie-player",{staticClass:"lottie-player",attrs:{autoplay:"",mode:"normal",src:t.urlMap[i.addCoin]}}):t._e(),e("div",{directives:[{name:"show",rawName:"v-show",value:i.isSay,expression:"item.isSay"}],staticClass:"audio-box"},[e("AudioWaves",{staticClass:"audio-waves",attrs:{animation:!0,size:"small",skin:"green","animation-type":"sound"}})],1)],1)})),0)},c=[],d=i("3835"),m=i("b85c"),p=i("2909"),h=(i("14d9"),i("4de4"),i("d3b7"),i("159b"),i("e260"),i("4ec9"),i("3ca3"),i("ddb0"),i("99af"),i("d81d"),i("6062"),i("a434"),i("a9e3"),i("217d")),f=(i("a717"),{components:{AudioWaves:h["a"]},props:{options:{type:Object,default:function(){return{isHistory:!1,ircMsg:{},roomMessage:{roomInfo:{commonOption:{},planInfo:{},stuInfo:{}}}}}}},data:function(){return{stuId:this.options.roomMessage.roomInfo.stuInfo.id,urlMap:{5:"./lottiefiles/coins/coins-add-5/data.json",10:"./lottiefiles/coins/coins-add-10/data.json"},ircMsg:this.options.ircMsg,stuList:[],diffInfo:{},pptratio:{width:"",height:""},boundingClientRect:{},data:[],isShowCoins:!1,msgType:null}},watch:{stuList:{handler:function(t,e){var i=this;switch(console.info("对象函数 handler(newVal, oldVal)",t,e,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),this.options.isHistory&&this.upDownClass(t,e),this.msgType){case 2:case 3:if(this.options.isHistory)return;console.log("multVideoLink-mounted","wathc",this.ircMsg,this.options.isHistory),this.upDownClass(t,e),console.log("datas",this.data);break;case 4:var n=t.filter((function(t){return 0!==t.addCoin}));this.data.forEach((function(t){return t.addCoin=0})),n.forEach((function(t){i.data.forEach((function(e){t.userId===e.userId&&(e.addCoin=t.addCoin)})),t.userId==i.stuId&&i.$bus.$emit("updateAchievement","add",t.addCoin)})),this.isShowCoins=!0;var o=null;if(o)return;o=setTimeout((function(){i.isShowCoins=!1,clearTimeout(o),o=null}),4e3);break;case 5:this.dragVideoView(t,e),this.$forceUpdate();break;default:break}},deep:!0}},computed:{},mounted:function(){var t=this;this.$bus.$emit("multVideoLinkStatus",{pub:!0,status:1}),this.$bus.$emit("raiseHandSendMessageToTeacher",{type:127}),this.$nextTick((function(){t.getSize(),window.addEventListener("resize",(function(){console.info("箭头函数 监听 resize,filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),t.getSize()}))})),console.log("multVideoLink-mounted",this.ircMsg,this.options.isHistory),this.receiveMessage(this.ircMsg),this.groupAudioVolumeIndication(),this.bindRtcEvent()},beforeDestroy:function(){var t=this;console.info("对象函数 beforeDestroy,filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),this.$bus.$emit("multVideoLinkStatus",{pub:!1}),this.$bus.$emit("raiseHandForMultVideoLink",!1),this.data.forEach((function(e){e.userId==t.stuId&&t.$bus.$emit("raiseHandDisabled",!1),t.$bus.$emit("multVideoLinkStatus",{pub:!0,status:3,stuId:e.userId})})),this.upDownClass([],this.data),this.rtcClass.teacherRtcChannel.off("remoteVideoStateChanged",this.listenRemoteVideoStateChanged)},methods:{getUpDownStuObj:function(t,e){console.info("对象函数 getUpDownStuObj(newVal, oldVal)",t,e,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue");var i=new Map,n=[].concat(Object(p["a"])(e),Object(p["a"])(t));n.forEach((function(t){i.set(t.userId,t)}));var o=e.map((function(t){return t.userId}))||[],s=t.map((function(t){return t.userId}))||[],a=new Set(s),r=new Set(o),u=o.filter((function(t){return!a.has(t)})),l=s.filter((function(t){return!r.has(t)}));return{downstu:u,upstu:l,allList:i}},upDownClass:function(t,e){var i=this;console.info("对象函数 upDownClass(newVal, oldVal)",t,e,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue");var n=this.getUpDownStuObj(t,e);n.downstu.forEach((function(t){return n.allList.delete(t)})),n.downstu.forEach((function(t){var e=null;i.data.forEach((function(i,n){t==i.userId&&(e=n)})),null!=e&&i.data.splice(e,1)})),n.upstu.forEach((function(t){i.data.length<=4&&i.data.push(n.allList.get(t))})),this.$nextTick((function(){console.log("multVideoLink-upstu",n.upstu),console.log("multVideoLink-downstu",n.downstu),n.upstu.forEach((function(t){i.$bus.$emit("multVideoLinkStatus",{pub:!0,status:2,stuId:t});var e="mult-video-".concat(t);t==i.stuId?(i.$bus.$emit("raiseHandDisabled",!0),i.setupLocalVideo(e)):setTimeout((function(){i.setupRemoteVideo(t,e),i.muteRemoteAudio(t,!1)}),1700)})),n.downstu.forEach((function(t){t==i.stuId&&i.$bus.$emit("raiseHandDisabled",!1),i.$bus.$emit("multVideoLinkStatus",{pub:!0,status:3,stuId:t}),i.muteRemoteAudio(t,!0)}))}))},receiveMessage:function(t){console.info("对象函数 receiveMessage(noticeContent)",t,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),console.log("multVideoLink-receiveMessage",t),this.msgType=t.status,1==this.msgType&&this.$bus.$emit("raiseHandForMultVideoLink",!0),this.stuList=t.data||[]},dragVideoView:function(t,e){var i=this;return console.info("对象函数 dragVideoView(newVal, oldVal)",t,e,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),t.forEach((function(t,n){e.forEach((function(e){t.originYRatio===e.originYRatio&&t.originXRatio===e.originXRatio||(i.data[n].originYRatio=t.originYRatio,i.data[n].originXRatio=t.originXRatio)}))})),t},switchSpking:function(t,e){var i=this;console.info("对象函数 switchSpking(type, id)",t,e,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),0===e&&(e=this.stuId),this.data.forEach((function(n){n.userId==e&&(n.isSay="off"!==t,i.$forceUpdate())}))},strMapToObj:function(t){console.info("对象函数 strMapToObj(strMap)",t,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue");var e,i=Object.create(null),n=Object(m["a"])(t);try{for(n.s();!(e=n.n()).done;){var o=Object(d["a"])(e.value,2),s=o[0],a=o[1];i[s]=a}}catch(r){n.e(r)}finally{n.f()}return i},getSize:function(){console.info("对象函数 getSize,filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),this.boundingClientRectController=document.getElementById("interactionController").getBoundingClientRect();var t=this.pptratio.width=this.boundingClientRectController.width,e=this.pptratio.height=this.boundingClientRectController.height;e/t>.75?(this.diffInfo={h:(e-t/4*3)/2,w:0},this.pptratio.height=e-2*this.diffInfo.h):(this.diffInfo={w:(t-e/3*4)/2,h:0},this.pptratio.width=t-2*this.diffInfo.w)},setupLocalVideo:function(t){console.info("对象函数 setupLocalVideo(id)",t,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),this.rtcEngine=window.RTC_COMMON.rtcEngine,this.rtcEngine.setupLocalVideo(document.getElementById(t))},setupRemoteVideo:function(t,e){console.info("对象函数 setupRemoteVideo(uid, id)",t,e,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),this.classRtcChannel=window.RTC_COMMON.classRtcChannel,this.classRtcChannel.setupRemoteVideo(Number(t),document.getElementById(e))},muteRemoteAudio:function(t,e){console.info("对象函数 muteRemoteAudio(uid, mute)",t,e,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),this.classRtcChannel=window.RTC_COMMON.classRtcChannel,this.classRtcChannel.muteRemoteAudioStream(Number(t),e)},groupAudioVolumeIndication:function(){var t=this;console.info("对象函数 groupAudioVolumeIndication,filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue");var e={};this.rtcEngine=window.RTC_COMMON.rtcEngine,this.rtcEngine.on("groupAudioVolumeIndication",(function(i){console.info("箭头函数 监听 groupAudioVolumeIndication(speakers)",i,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),i.forEach((function(i){!e[i.uid]&&(e[i.uid]=1),i.volume>100?t.switchSpking("say",i.uid):(e[i.uid]=e[i.uid]+1,5===e[i.uid]&&(e={},t.switchSpking("off",i.uid)))}))}))},bindRtcEvent:function(){console.info("对象函数 bindRtcEvent,filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),this.classRtcChannel=window.RTC_COMMON.classRtcChannel,this.classRtcChannel.on("remoteVideoStateChanged",this.listenRemoteVideoStateChanged)},listenRemoteVideoStateChanged:function(t,e,i){console.info("对象函数 listenRemoteVideoStateChanged(uid, state, reason)",t,e,i,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue"),console.log("multVideoLink-remoteVideoStateChanged-1",t,e,i),this.data.forEach((function(e){t==e.userId&&(e.cameraIsOpen=3==i||5==i||7==i?2:1)}))},destroyInteraction:function(t){var e;console.info("对象函数 destroyInteraction(options)",t,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/app.vue");var i=t.ircMsg;this.upDownClass(i.data,this.data),this.$destroy(),null===(e=this.$el)||void 0===e||null===(e=e.parentNode)||void 0===e||e.removeChild(this.$el)}}}),v=f,C=(i("3a6e"),i("2877")),g=Object(C["a"])(v,l,c,!1,null,"69e35906",null),w=g.exports,b=function(t){Object(a["a"])(i,t);var e=Object(r["a"])(i);function i(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return console.info("函数申明 MultVideoLink(opts)",n,"filePath:renderer/components/Classroom/CommonInteractions/multVideoLink/index.js"),Object(o["a"])(this,i),t=e.call(this,w),t.options=n,t.dom=n.roomMessage.roomInfo.interactionController,t.initVmApp("多人连麦"),t}return Object(s["a"])(i,[{key:"createPropsData",value:function(){var t={};return Object(n["a"])({options:this.options},t)}}]),i}(u["a"])},"217d":function(t,e,i){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"audio-waves",class:[t.skinClass,t.size]},[t.animation?e("div",{staticClass:"waves-wrapper"},[e("span",{staticClass:"waves-item waves-animation waves1",class:t.animationTypeClass}),e("span",{staticClass:"waves-item waves-animation waves2",class:t.animationTypeClass}),e("span",{staticClass:"waves-item waves-animation waves3",class:t.animationTypeClass}),e("span",{staticClass:"waves-item waves-animation waves4",class:t.animationTypeClass}),"large"===t.size?e("span",{staticClass:"waves-item waves-animation waves5",class:t.animationTypeClass}):t._e(),"large"===t.size?e("span",{staticClass:"waves-item waves-animation waves6",class:t.animationTypeClass}):t._e()]):e("div",{staticClass:"waves-wrapper"},[e("span",{staticClass:"waves-item default-bg waves1"}),e("span",{staticClass:"waves-item default-bg waves2"}),e("span",{staticClass:"waves-item default-bg waves3"}),e("span",{staticClass:"waves-item default-bg waves4"}),"large"===t.size?e("span",{staticClass:"waves-item default-bg waves5"}):t._e(),"large"===t.size?e("span",{staticClass:"waves-item default-bg waves6"}):t._e()])])},o=[],s={props:{animation:{default:!1,type:Boolean},animationType:{default:"liner",type:String},size:{default:"large",type:String},skin:{default:"orange",type:String}},computed:{skinClass:function(){return console.info("对象函数 skinClass,filePath:renderer/components/Common/AudioWaves.vue"),"skin-".concat(this.skin)},animationTypeClass:function(){return console.info("对象函数 animationTypeClass,filePath:renderer/components/Common/AudioWaves.vue"),"animation-".concat(this.animationType)}}},a=s,r=(i("29df"),i("2877")),u=Object(r["a"])(a,n,o,!1,null,"1051bd64",null);e["a"]=u.exports},"29df":function(t,e,i){"use strict";i("5ddf")},"3a6e":function(t,e,i){"use strict";i("84e1")},"5ddf":function(t,e,i){},"84e1":function(t,e,i){},b6c9:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i("d4ec"),o=i("bee2"),s=(i("99af"),i("d9e2"),i("8bbf")),a=i.n(s),r=i("3898"),u=i("d0db"),l=function(){function t(e){console.info("函数申明 InteractionBase(app)",e,"filePath:renderer/components/Classroom/CommonInteractions/interaction-base.js"),Object(n["a"])(this,t),this.app=e,this.vm=null,this.keepOtherDom=!1}return Object(o["a"])(t,[{key:"initVmApp",value:function(t){if(!this.dom)throw Error("互动的dom容器不存在");this.dom.children.length>0&&!this.keepOtherDom&&(u["a"].send({tag:"tempInteractionTest",content:{msg:"清空互动容器，由".concat(t,"触发清空，清空").concat(this.dom.children[0].className)}}),this.dom.innerHTML=""),this.vm=this.initVm(this.app),this.render(this.dom,this.vm)}},{key:"initVm",value:function(t){var e=a.a.extend(t),i=this.createPropsData(),n=new e({i18n:r["b"],propsData:i,store:this.store||{}});return n.$mount(),n}},{key:"render",value:function(t,e){t.appendChild(e.$el)}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.submit,i=t.key,n=void 0===i?"":i;if(this.vm){var o,s;if(e&&this.vm.submit(),this.vm.$destroy(),"classRest"===n)null===this||void 0===this||null===(o=this.dom)||void 0===o||o.removeChild(null===this||void 0===this||null===(s=this.vm)||void 0===s?void 0:s.$el);else this.dom.innerHTML="";this.vm=null,this.app=null}}},{key:"getProperties",value:function(t,e){return t["".concat(e)].properties}},{key:"handleMsg",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log(t)}}]),t}()}}]);
//# sourceMappingURL=chunk-bc172820.98cb14c6.js.map