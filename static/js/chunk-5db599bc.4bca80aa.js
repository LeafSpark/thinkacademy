(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5db599bc"],{"030f":function(t,e,o){"use strict";var n=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"progressContainer"},[e("div",{staticClass:"progress"},[e("div",{staticClass:"progress-text"},[t._v(t._s(t.$t("common.uploading"))+"… "+t._s(t.percent)+"%")]),e("a-progress",{attrs:{percent:t.percent,"stroke-color":{"0%":"rgba(255,213,24,1)","100%":"rgba(255,170,10,1)"},strokeWidth:4,showInfo:!1}})],1)]):t._e()},i=[],a=(o("a9e3"),{name:"photoWallProgress",props:{visible:{type:Boolean,default:!1},percent:{type:Number,default:0}},methods:{}}),s=a,r=(o("4dec"),o("2877")),c=Object(r["a"])(s,n,i,!1,null,"38106901",null);e["a"]=c.exports},1385:function(t,e,o){"use strict";o.r(e),o.d(e,"default",(function(){return E}));var n=o("5530"),i=o("d4ec"),a=o("bee2"),s=o("262e"),r=o("2caf"),c=o("b6c9"),l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"photoWallContainer",attrs:{id:"photoWallContainer"}},[e("div",{ref:"countdownContainer",staticClass:"countdownContainer",style:t.countdownStyle,attrs:{id:"countdownContainer"}},[e("i",{staticClass:"countDown-icon"}),e("NeCountdown",{ref:"countDown",staticClass:"countdown",attrs:{time:t.countDownTime,format:"mm:ss"},on:{complete:t.countdownComplete}})],1),t.showCamera||t.showGraffiti?e("div",{staticClass:"toolbar",attrs:{id:"toolbar"}},[e("i",{staticClass:"back",on:{click:t.goClassRoom}})]):t._e(),!t.isSubmit&&t.isCanOpenCamera?e("div",{ref:"photoShotBtn",staticClass:"photoShotBtn",class:t.disableCamera,attrs:{id:"photoShotBtnId"},on:{click:t.openClassCamera}},[e("i")]):t._e(),t.showCamera&&!t.showGraffiti?e("camera",{attrs:{delay:2e3,options:t.options},on:{changeTakePhotoWay:t.changeTakePhotoWay,submit:t.submitPhoto,photoData:t.getPhotoData}}):t._e(),t.showGraffiti&&!t.showCamera?e("graffiti",{attrs:{options:t.options,cameraAccess:t.cameraAccess,closeInteractive:t.closeInteractive},on:{submit:t.submitPhoto,photoData:t.getPhotoData,changeTakePhotoWay:t.changeTakePhotoWay}}):t._e(),!t.showPhotoShotTip||t.isSubmit||t.userClosePhotoShotTip?t._e():e("div",{ref:"photoShotTip",staticClass:"photoShotTip animateSlideInDown"},[e("div",{staticClass:"close",on:{click:t.closePhotoShotTip}}),e("ul",[e("li",[t._v(t._s(this.$t("classroom.interactions.photoWall.hasAccessNotice")[0]))]),e("li",[t._v(t._s(this.$t("classroom.interactions.photoWall.hasAccessNotice")[1]))]),e("li",[t._v(t._s(this.$t("classroom.interactions.photoWall.hasAccessNotice")[2]))])])]),t.cameraAccess?t._e():e("div",{staticClass:"cameraAccessToast animateFadeIn"},[e("p",[t._v(" "+t._s(this.$t("classroom.interactions.photoWall.notAccessNotice")[0])),e("br"),t._v(" "+t._s(this.$t("classroom.interactions.photoWall.notAccessNotice")[1])+" ")]),e("div",{staticClass:"showGraffiti",on:{click:t.openClassGraffiti}},[t._v("去涂鸦")])]),e("photoWallDialog",{attrs:{cancelText:t.$t("common.no"),confirmText:t.confirmText,visible:t.dialogVisible,content:t.dialogContent,description:t.dialogDescription},on:{cancel:t.dialogCancel,confirm:t.dialogConfirm}}),e("uploadProgress",{attrs:{percent:t.percent,visible:t.showUploadProgress}}),e("MediaSecurityAccess",{attrs:{type:"camera",visible:!0}}),e("audio",{ref:"photoWallBeginSound",staticClass:"hide",attrs:{src:o("79d5")}}),e("audio",{ref:"photoWallBtnSound",staticClass:"hide",attrs:{src:o("e28a")}}),e("audio",{ref:"photoWallSuccessSound",staticClass:"hide",attrs:{src:o("8b88")}}),t.coinShow?e("FlyCoin",{attrs:{rainCoin:t.rainCoin},on:{palyEnd:t.onCoinFlyComplete}}):t._e()],1)},A=[],d=o("c7eb"),h=o("1da1"),u=(o("99af"),o("0d52")),m=o("dad2"),p=o("e811"),f=o("36e9"),g=o("75b9"),v=o("030f"),b=o("e39c"),C=o("3b29"),y=o("1a37"),w=o("3898"),S=o("d0db"),T=o("e417"),I=o("bcaf"),W=o("c02a"),k=o("68cb"),P={name:"PhotoWall",props:{options:{type:Object,default:function(){return{}}}},i18n:w["b"],components:{camera:p["a"],graffiti:f["a"],photoWallDialog:g["a"],uploadProgress:v["a"],MediaSecurityAccess:C["a"],FlyCoin:k["a"]},data:function(){return{showPhotoShotTip:!1,userClosePhotoShotTip:!1,dialogVisible:!1,cameraAccess:!0,isCountdownComplete:!1,countDownTime:0,showCamera:!1,showGraffiti:!1,isSubmit:!1,submiting:!1,submitTimer:null,submitCountdown:5,confirmText:"".concat(this.$t("common.yes")," (5)"),percent:0,showUploadProgress:!1,photoData:!1,uploadError:!1,closeInteractive:!1,isInteraction:!1,classType:0,isCanOpenCamera:!0,coinShow:!1,rainCoin:0}},created:function(){this.photoWall=new m["a"](Object(n["a"])({},this.options)),this.countDownTime=this.photoWall.initCountdownTime()||0,this.classType=this.options.roomMessage.roomInfo.commonOption.classType},mounted:function(){var t=this;this.userTrackLogger("拍照上墙启动"),this.$nextTick(Object(h["a"])(Object(d["a"])().mark((function e(){var o;return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.$refs.photoWallBeginSound.play(),t.$bus.$emit("photoWallInteractId",t.options.ircMsg.interactId),t.photoWall.interactOpen(),t.getWallStatus(),e.next=6,u["nativeApi"].getMediaAccessStatus("camera");case 6:if(o=e.sent,"granted"===o){e.next=11;break}return t.sendLogger("拍照上墙初始化摄像头无权限，code:".concat(o),"init"),t.cameraAccess=!1,e.abrupt("return");case 11:t.showPhotoShotTip=!0,localStorage.setItem("photoWallOptions",JSON.stringify(t.options));case 13:case"end":return e.stop()}}),e)}))))},computed:{countdownStyle:function(){return this.showCamera||this.showGraffiti?"left:67.5%":""},disableCamera:function(){return!this.cameraAccess&&"disabled"}},methods:{changeTakePhotoWay:function(t){"graffiti"===t?(this.showCamera=!1,this.showGraffiti=!0,this.sendLogger("切换到涂鸦板成功")):(this.showCamera=!0,this.showGraffiti=!1,this.sendLogger("切换到拍照成功"))},closePhotoShotTip:function(){this.sendLogger("点击关闭有权限提示层"),this.showPhotoShotTip=!1,this.userClosePhotoShotTip=!0},openClassCamera:function(){var t=this;this.$nextTick((function(){t.$refs.photoWallBtnSound.play()})),this.showCamera=!this.showCamera,this.isInteraction=!0,this.sendLogger("打开拍照弹层成功"),this.addSmallClassStyle(),Object(T["e"])("hw_classroom_interact_photograph_click",this.options.roomMessage.roomInfo.commonOption,{interact_id:this.options.ircMsg.interactId})},sendPeerMessageToTutor:function(t){var e={type:170,isFunction:1,msg:"拍照上墙",parameter:{cameraBusy:t}};window.ChatClient.PeerChatManager.sendPeerMessage([{nickname:this.options.roomMessage.roomInfo.configs.tutorIrcId}],JSON.stringify(e),I["a"].privMsg)},openClassGraffiti:function(){this.showGraffiti=!this.showGraffiti,this.isInteraction=!0,this.sendLogger("打开涂鸦板成功"),this.addSmallClassStyle()},goClassRoom:function(){this.sendLogger("点击返回课堂"),this.showPhotoShotTip=!0,this.showCamera=this.showGraffiti=this.isInteraction=!1,this.removeSmallClassStyle()},getPhotoData:function(t){this.sendLogger("[拍照上墙]获取图片数据"),this.photoData=t},getWallStatus:function(){var t=this;return Object(h["a"])(Object(d["a"])().mark((function e(){var o,n,i;return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.photoWall.getWallStatus();case 3:o=e.sent,n=o.code,i=o.data,S["a"].send({tag:"student.Interact",content:{interactType:"PhotoWall",msg:"拍照上墙异常恢复",code:n,data:i}}),0===n&&(t.isSubmit=i.isSubmit),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),S["a"].send({tag:"student.Interact",content:{interactType:"PhotoWall",msg:"拍照上墙异常恢复错误",error:e.t0},level:"error"});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},interactiveOver:function(){var t=this;return Object(h["a"])(Object(d["a"])().mark((function e(){return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showPhotoShotTip=!1,e.next=3,Object(b["f"])(800);case 3:if(t.photoData||t.isSubmit||t.submiting){e.next=7;break}return t.sendLogger("没参与拍照上墙结束"),t.photoWall.showNotjoinTip({className:t.showGraffiti||t.showCamera?"":"notJoin",tips:t.$t("classroom.interactions.photoWall.notjoinTip"),callback:function(){t.destroy()}}),e.abrupt("return");case 7:if(!t.photoData||t.isSubmit||t.submiting){e.next=15;break}return t.sendLogger("有图片数据，弹框提醒提交"),t.clearSubmitTimer(),t.dialogContent=t.$t("classroom.interactions.photoWall.endNotice")[0],t.dialogDescription=t.$t("classroom.interactions.photoWall.endNotice")[1],t.dialogVisible=!0,t.submitTimer=setInterval((function(){t.submitCountdown--,t.confirmText="".concat(t.$t("common.yes")," (").concat(t.submitCountdown,")"),0===t.submitCountdown&&(clearInterval(t.submitTimer),t.submitTimer=null,t.destroy())}),1e3),e.abrupt("return");case 15:t.destroy();case 16:case"end":return e.stop()}}),e)})))()},submitPhoto:function(){var t=this;return Object(h["a"])(Object(d["a"])().mark((function e(){var o,n,i,a,s;return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.sendLogger("[拍照上墙]提交数据"),!t.submiting||!t.closeInteractive){e.next=4;break}return S["a"].send({tag:"student.Interact",content:{interactType:"PhotoWall",msg:"提交中或者老师已经关闭互动"}}),e.abrupt("return");case 4:return t.dialogVisible=t.showPhotoShotTip=!1,t.submiting=t.showUploadProgress=!0,t.isCanOpenCamera=!1,o=new y["b"]({scene:"pictureWall"}),t.photoData.base64&&t.photoData.base64.substring(t.photoData.base64.indexOf(",")+1).length>0?S["a"].send({tag:"student.Interact",content:{interactType:"PhotoWall",msg:"base64有内容开始拍照上墙文件上传"}}):S["a"].send({tag:"student.Interact",content:{interactType:"PhotoWall",msg:"拍照文件为空"},level:"error"}),e.prev=9,e.next=12,o.putFile({filePath:"pictureWall.jpg",file:t.photoData.blob,progress:function(e){t.percent=e},success:function(e){var o;t.sendLogger("上传照片成功, url: ".concat(e.url)),W["l"](null===(o=t.options)||void 0===o||null===(o=o.ircMsg)||void 0===o?void 0:o.interactId,e)},fail:function(e){t.showUploadProgress=!1,t.submiting=!1,t.percent=0,t.photoWall.showSubmitTip({text:t.$t("common.uploadFailed"),icon:"error",callback:function(){t.isCountdownComplete&&t.destroy()}}),console.error("上传照片失败",e),t.sendLogger("上传照片失败","","error")}});case 12:if(n=e.sent,i=n.key,!i){e.next=22;break}return t.showUploadProgress=!1,t.photoWall.showSubmitTip({text:"".concat(t.$t("common.submiting"),"..."),icon:"loading",duration:0}),e.next=19,t.photoWall.submitPhoto(i);case 19:a=e.sent,S["a"].send({tag:"student.Interact",content:{interactType:"PhotoWall",msg:"拍照上墙提交地址完毕",submitRes:a}}),0===a.code&&a.data?(s=a.data.rightCoin,t.showGraffiti=t.showCamera=!1,t.isSubmit=!0,t.removeSmallClassStyle(),t.$nextTick((function(){var e;null===(e=t.$refs.photoWallSuccessSound)||void 0===e||e.play()})),t.photoWall.showCoinsTip({coins:1!==t.options.ircMsg.rewardType?s:0,tips:t.$t("common.sumbittedSuccessfully"),callback:function(){var e;if(t.closeInteractive)return t.destroy();t.rainCoin=s,t.coinShow=!!s,t.isInteraction=!1,null!==(e=t.$refs)&&void 0!==e&&e.photoShotBtn&&(t.$refs.photoShotBtn.style.display="none")}}),t.sendLogger("获得金币成功, ".concat(JSON.stringify(a)))):(t.submiting=!1,t.percent=0,t.photoWall.showSubmitTip({text:t.$t("common.submissionFailed"),icon:"error",callback:function(){t.isCountdownComplete&&t.destroy()}}),t.sendLogger("获得金币失败, ".concat(JSON.stringify(a))));case 22:e.next=29;break;case 24:e.prev=24,e.t0=e["catch"](9),t.$Message.error({content:t.$t("setting.reportLogs.uploadfailed"),duration:2}),t.showUploadProgress=!1,t.isCanOpenCamera=!0;case 29:case"end":return e.stop()}}),e,null,[[9,24]])})))()},onCoinFlyComplete:function(){this.coinShow=!1,this.rainCoin=0},dialogCancel:function(){this.sendLogger("弹框提醒取消按钮点击"),this.clearSubmitTimer(),this.destroy()},dialogConfirm:function(){this.sendLogger("弹框提醒提交按钮点击"),this.clearSubmitTimer(),this.confirmText="".concat(this.$t("common.submiting"),"..."),this.submitPhoto()},clearSubmitTimer:function(){this.submitTimer&&(clearInterval(this.submitTimer),this.submitTimer=null)},countdownComplete:function(){},destroyInteraction:function(){var t=this;return Object(h["a"])(Object(d["a"])().mark((function e(){return Object(d["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return document.getElementById("correctPhotoWallContainer")||t.sendPeerMessageToTutor(2),t.closeInteractive=!0,t.isCanOpenCamera=!1,t.$bus.$emit("photoWallInteractId",null),e.next=6,t.interactiveOver();case 6:case"end":return e.stop()}}),e)})))()},addSmallClassStyle:function(){var t=this;this.$nextTick((function(){2==t.classType&&(Object(b["a"])(document.getElementById("countdownContainer"),"smallclass-countdownContainer"),Object(b["a"])(document.getElementById("toolbar"),"small-class-toolbar"))}))},removeSmallClassStyle:function(){2==this.classType&&(Object(b["y"])(document.getElementById("countdownContainer"),"smallclass-countdownContainer"),Object(b["y"])(document.getElementById("toolbar"),"small-class-toolbar"))},sendLogger:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info";S["a"].send({tag:"student.Interact",content:{msg:t,interactType:"PhotoWall",interactId:this.options.ircMsg.interactId,interactStage:e},level:o})},userTrackLogger:function(t){S["a"].send({tag:"userTrack",content:{msg:t,tag:"student.Interact",interactType:"PhotoWall"}})},destroy:function(){this.clearSubmitTimer(),this.$el&&this.$el.parentNode&&(this.$bus.$emit("updateAchievement","update"),this.$bus.$off("changeTakePhotoWay"),this.$bus.$emit("photoWallInteractId",null),this.$destroy(),this.$el.parentNode.removeChild(this.$el),Object(b["y"])(document.getElementById("interactionController"),"index-1000"),this.userTrackLogger("拍照上墙结束"))}},watch:{showCamera:{handler:function(t){t&&this.photoWall.showShortCutTip({tips:this.$t("classroom.interactions.photoWall.shortCutTip")});var e=t?1:2;this.sendPeerMessageToTutor(e)},deep:!0,immediate:!0},isInteraction:function(t){t?Object(b["a"])(document.getElementById("interactionController"),"index-1000"):Object(b["y"])(document.getElementById("interactionController"),"index-1000")}}},O=P,x=(o("3491"),o("496d"),o("2877")),j=Object(x["a"])(O,l,A,!1,null,"59f8997c",null),L=j.exports,E=function(t){Object(s["a"])(o,t);var e=Object(r["a"])(o);function o(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])(this,o),t=e.call(this,L),t.options=n,t.dom=n.roomMessage.roomInfo.interactionController,t.initVmApp("拍照上墙"),t}return Object(a["a"])(o,[{key:"createPropsData",value:function(){var t={};return Object(n["a"])({options:this.options},t)}}]),o}(c["a"])},"2c82":function(t,e,o){},3491:function(t,e,o){"use strict";o("abc5")},"36e9":function(t,e,o){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"photoShotContainer"},[e("div",{staticClass:"tools"},[e("div",{staticClass:"graffitiTools"},[e("i",{staticClass:"icon draw select",on:{click:t.graffitiDraw}},[t._v("画笔")]),e("i",{staticClass:"icon eraser",on:{click:t.graffitiEraser}},[t._v("橡皮擦")]),e("i",{staticClass:"icon prev",on:{click:t.graffitiPrev}},[t._v("上一步")]),e("i",{staticClass:"icon next",on:{click:t.graffitiNext}},[t._v("下一步")])]),e("div",{staticClass:"userTools"},[e("div",{staticClass:"goCamera",class:t.disableCamera,on:{click:t.goCamera}},[e("span",[t._v(t._s(t.$t("classroom.interactions.photoWall.cameraBtnName")))]),e("a-icon",{attrs:{type:"caret-right"}})],1),e("a-button",{staticClass:"submit-btn",attrs:{shape:"round"},on:{click:t.confirmSubmit}},[t._v(t._s(t.$t("common.submit")))])],1)]),e("div",{staticClass:"graffitiContainer",attrs:{id:"graffitiContainer"}}),e("photoWallDialog",{attrs:{cancelText:t.$t("common.cancel"),confirmText:t.$t("common.submit"),visible:t.dialogVisible,content:t.dialogContent},on:{cancel:t.cancel,confirm:t.confirm}})],1)},i=[],a=o("c7eb"),s=o("1da1"),r=(o("d3b7"),o("159b"),o("99af"),o("6e4d")),c=o.n(r),l=o("e39c"),A=o("75b9"),d=o("e417"),h=o("d0db"),u={name:"photoShotGraffiti",props:{cameraAccess:{style:Boolean,default:!1},closeInteractive:{style:Boolean,default:!1},options:{type:Object,default:function(){return{}}}},data:function(){return{graffiti:null,dialogVisible:!1,dialogContent:null,dialogDescription:null,graffitiInit:{dom:"graffitiContainer",width:840,height:630,quality:.8,lineColor:"#FFCF1B",background:"#111111",lineSize:2}}},components:{photoWallDialog:A["a"]},mounted:function(){var t=this;this.$nextTick(Object(s["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c.a.init(t.graffitiInit);case 2:t.graffiti=e.sent,t.graffiti.setAttribute("class","penCursor"),c.a.draw();case 5:case"end":return e.stop()}}),e)}))))},computed:{disableCamera:function(){return console.info("对象函数 disableCamera,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),!this.cameraAccess&&"disabled"}},methods:{setClass:function(t){console.info("对象函数 setClass(target)",t,"filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),t.parentNode.children.forEach((function(t){Object(l["y"])(t,"select")})),Object(l["a"])(t,"select")},goCamera:function(){console.info("对象函数 goCamera,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),h["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"点击切换到相机",disableCamera:this.disableCamera}}),c.a.destroy(),this.graffiti=null,this.$emit("changeTakePhotoWay","camera")},graffitiDraw:function(t){console.info("对象函数 graffitiDraw(e)",t,"filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),h["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"选择画笔"}}),this.setClass(t.target),this.graffiti.setAttribute("class","penCursor"),c.a.draw()},graffitiEraser:function(t){console.info("对象函数 graffitiEraser(e)",t,"filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),h["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"选择涂鸦橡皮擦"}}),this.setClass(t.target),this.graffiti.setAttribute("class","eraserCursor"),c.a.eraser(20)},graffitiPrev:function(){console.info("对象函数 graffitiPrev,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),h["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"选择涂鸦上一步"}}),c.a.prev()},graffitiNext:function(){console.info("对象函数 graffitiNext,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),h["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"选择涂鸦下一步"}}),c.a.next()},createImage:function(){var t=this;return Object(s["a"])(Object(a["a"])().mark((function e(){var o;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.info("对象函数 createImage,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),e.next=3,c.a.createImage();case 3:o=e.sent,0===o.errCode&&t.$emit("photoData",o.data);case 5:case"end":return e.stop()}}),e)})))()},confirmSubmit:function(){console.info("对象函数 confirmSubmit,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),h["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"点击提交涂鸦按钮"}}),this.dialogContent="\n        ".concat(this.$t("classroom.interactions.photoWall.confirmNotice")[0],"<br>\n        ").concat(this.$t("classroom.interactions.photoWall.confirmNotice")[1],"\n      "),this.dialogVisible=!0},cancel:function(){console.info("对象函数 cancel,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),h["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"点击弹窗取消提交"}}),this.dialogVisible=!1},confirm:function(){var t=this;return Object(s["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.info("对象函数 confirm,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),h["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"点击弹窗确认提交"}}),t.dialogVisible=!1,e.next=5,t.createImage();case 5:Object(d["e"])("hw_classroom_interact_photograph_submit",t.options.roomMessage.roomInfo.commonOption,{interact_id:t.options.ircMsg.interactId,submit_type:2}),t.$emit("submit");case 7:case"end":return e.stop()}}),e)})))()}},beforeDestroy:function(){console.info("对象函数 beforeDestroy,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),c.a.destroy(),console.log("Graffiti destroy")},watch:{closeInteractive:function(t){console.info("对象函数 closeInteractive(val)",t,"filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/graffiti.vue"),t&&(h["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"监听关闭互动，创建涂鸦图片"}}),this.createImage())}}},m=u,p=(o("c6a1"),o("2877")),f=Object(p["a"])(m,n,i,!1,null,"4eba0760",null);e["a"]=f.exports},"496d":function(t,e,o){"use strict";o("ed57")},"4dec":function(t,e,o){"use strict";o("c17f")},"5afe":function(t,e,o){},"5cbb":function(t,e,o){"use strict";o("2c82")},"68cb":function(t,e,o){"use strict";var n=o("5530"),i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mask"},[e("div",{ref:"rainCoin",style:Object(n["a"])({width:"".concat(t.getCoinWidth,"px"),height:"".concat(t.getCoinHeight,"px")},t.getCoinMargin)},[e("lottie-player",{attrs:{id:"wallCoinPlay",mode:"normal",autoplay:"",src:"./lottiefiles/redRain/coin/index.json"},on:{complete:t.onLottieComplete}})],1),e("Coin",{attrs:{x:t.coinX,y:t.coinY,coin:t.rainCoin}}),e("audio",{ref:"coinFly",attrs:{src:o("f5b3")}})],1)},a=[],s=(o("a9e3"),o("caad"),o("2532"),o("9151")),r=o("612a"),c=o("b047"),l=o.n(c),A={data:function(){return{coinX:0,coinY:0}},props:{rainCoin:{type:Number,default:0}},components:{Coin:s["a"]},computed:{containerSize:function(){return console.info("对象函数 containerSize,filePath:renderer/components/Common/FlyCoin.vue"),location.pathname.includes("largeClass.html")?(this.containerDom||this.setCoursewareAdaptation(),{width:this.containerDom.offsetWidth,height:this.containerDom.offsetHeight}):{width:r["a"].state.smallClass.coursesPosition.width,height:r["a"].state.smallClass.coursesPosition.height}},getCoinWidth:function(){console.info("对象函数 getCoinWidth,filePath:renderer/components/Common/FlyCoin.vue");var t=this.containerSize.width/this.containerSize.height;if(t>1.046){var e=229/572*this.containerSize.height;return 1.046*e}var o=240/763*this.containerSize.width;return o/1.046},getCoinHeight:function(){return console.info("对象函数 getCoinHeight,filePath:renderer/components/Common/FlyCoin.vue"),this.getCoinWidth/1.046},getCoinMargin:function(){return console.info("对象函数 getCoinMargin,filePath:renderer/components/Common/FlyCoin.vue"),{top:"".concat((this.containerSize.height-this.getCoinHeight)/2,"px"),left:"".concat((this.containerSize.width-this.getCoinWidth)/2,"px")}}},mounted:function(){var t=this;this.$nextTick((function(){var e;location.pathname.includes("largeClass.html")&&window.addEventListener("resize",t.setCoursewareAdaptation);var o=t.$refs.rainCoin.getBoundingClientRect(),n=o.left,i=o.top,a=o.width,s=o.height;t.coinX=n+(a-59)/2,t.coinY=i+(s-59)/2,null===(e=t.$refs)||void 0===e||null===(e=e.coinFly)||void 0===e||e.play()}))},destroyed:function(){console.info("对象函数 destroyed,filePath:renderer/components/Common/FlyCoin.vue"),location.pathname.includes("largeClass.html")&&window.removeEventListener("resize",this.setCoursewareAdaptation)},methods:{onLottieComplete:function(){console.info("对象函数 onLottieComplete,filePath:renderer/components/Common/FlyCoin.vue"),this.$emit("palyEnd")},setCoursewareAdaptation:l()((function(){var t=document.getElementById("interactionController");this.containerDom={offsetWidth:t.offsetWidth,offsetHeight:t.offsetHeight}}),300,{leading:!0})}},d=A,h=(o("f839"),o("2877")),u=Object(h["a"])(d,i,a,!1,null,"45b0e8e3",null);e["a"]=u.exports},"73cb":function(t,e,o){},"75b9":function(t,e,o){"use strict";o("a4d3"),o("e01a");var n=function(){var t=this,e=t._self._c;return e("a-modal",{staticClass:"photoShot-modal",attrs:{closable:!1,maskClosable:!1,width:t.width,destroyOnClose:!0,centered:"",zIndex:2021},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.title?e("h2",[t._v(t._s(t.title))]):t._e(),t.content?e("h3",{domProps:{innerHTML:t._s(t.content)}}):t._e(),t.description?e("p",{domProps:{innerHTML:t._s(t.description)}}):t._e(),e("template",{slot:"footer"},[e("button",{staticClass:"ant-btn",attrs:{type:"button"},on:{click:t.cancel}},[e("span",[t._v(t._s(t.cancelText))])]),e("a-button",{staticClass:"ant-btn-primary",attrs:{loading:t.loading},on:{click:t.confirm}},[e("span",[t._v(t._s(t.confirmText))])])],1)],2)},i=[],a=(o("a9e3"),void 0),s={name:"dialog",props:{visible:{type:Boolean,default:!0},width:{type:Number,default:380},title:{type:String,default:""},content:{type:String,default:""},description:{type:String,default:""},cancelText:{type:String,default:function(){return a.$t("common.cancel")}},confirmText:{type:String,default:function(){return a.$t("common.confirm")}},loading:{type:Boolean,default:!1},getContainer:{type:String,default:"photoWallContainer"}},data:function(){return{disabled:!1}},methods:{cancel:function(){console.info("对象函数 cancel,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/dialog.vue"),this.$emit("cancel")},confirm:function(){console.info("对象函数 confirm,filePath:renderer/components/Classroom/CommonInteractions/photoWall/components/dialog.vue"),this.disabled=!0,this.$emit("confirm")}}},r=s,c=o("2877"),l=Object(c["a"])(r,n,i,!1,null,null,null);e["a"]=l.exports},"79d5":function(t,e,o){t.exports=o.p+"static/media/photowall-begin.563c00a9.mp3"},"8b88":function(t,e,o){t.exports=o.p+"static/media/photowall-submit-success.ba915894.mp3"},9151:function(t,e,o){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"coin",style:t.coinStyle},[e("div",{staticClass:"top1",style:t.targetStyle,on:{animationend:t.addCoinStart}}),e("div",{staticClass:"top2",style:t.targetStyle}),e("div",{staticClass:"top3",style:t.targetStyle}),e("div",{staticClass:"mid1",style:t.targetStyle}),e("div",{staticClass:"mid2",style:t.targetStyle}),e("div",{staticClass:"mid3",style:t.targetStyle}),e("div",{staticClass:"bottom1",style:t.targetStyle}),e("div",{staticClass:"bottom2",style:t.targetStyle}),e("div",{staticClass:"bottom3",style:t.targetStyle})])},i=[],a=(o("a9e3"),o("caad"),o("2532"),{props:{x:{type:Number,default:0},y:{type:Number,default:0},coin:{type:Number,default:0}},computed:{coinStyle:function(){return console.info("对象函数 coinStyle,filePath:renderer/components/Classroom/CommonInteractions/redPacket/Coin.vue"),{left:"".concat(this.x,"px"),top:"".concat(this.y,"px")}},getTarget:function(){if(console.info("对象函数 getTarget,filePath:renderer/components/Classroom/CommonInteractions/redPacket/Coin.vue"),location.pathname.includes("largeClass.html")){var t=document.querySelector(".achievement-container .coins-icon");if(t)return{left:t.left,top:t.top,height:26,width:26};var e=document.querySelector(".video-local").getBoundingClientRect(),o=e.left,n=e.top;return{left:o,top:n,height:22,width:22}}return document.querySelector(".icon-coins").getBoundingClientRect()},targetX:function(){console.info("对象函数 targetX,filePath:renderer/components/Classroom/CommonInteractions/redPacket/Coin.vue");var t=this.getTarget,e=t.left,o=t.width;return e-this.x-o/2},targetY:function(){console.info("对象函数 targetY,filePath:renderer/components/Classroom/CommonInteractions/redPacket/Coin.vue");var t=this.getTarget,e=t.top,o=t.height;return this.y-e+o/2}},data:function(){return{targetStyle:{}}},methods:{addCoinStart:function(){console.info("对象函数 addCoinStart,filePath:renderer/components/Classroom/CommonInteractions/redPacket/Coin.vue"),this.$bus.$emit("addCoin",!0,this.coin)}},watch:{x:function(t){console.info("对象函数 x(val)",t,"filePath:renderer/components/Classroom/CommonInteractions/redPacket/Coin.vue"),t&&(this.targetStyle={left:"".concat(this.targetX,"px"),bottom:"".concat(this.targetY,"px")})}}}),s=a,r=(o("ab09"),o("2877")),c=Object(r["a"])(s,n,i,!1,null,"5d63d60b",null);e["a"]=c.exports},a6e8:function(t,e,o){},ab09:function(t,e,o){"use strict";o("5afe")},abc5:function(t,e,o){},b6c9:function(t,e,o){"use strict";o.d(e,"a",(function(){return l}));var n=o("d4ec"),i=o("bee2"),a=(o("99af"),o("d9e2"),o("8bbf")),s=o.n(a),r=o("3898"),c=o("d0db"),l=function(){function t(e){console.info("函数申明 InteractionBase(app)",e,"filePath:renderer/components/Classroom/CommonInteractions/interaction-base.js"),Object(n["a"])(this,t),this.app=e,this.vm=null,this.keepOtherDom=!1}return Object(i["a"])(t,[{key:"initVmApp",value:function(t){if(!this.dom)throw Error("互动的dom容器不存在");this.dom.children.length>0&&!this.keepOtherDom&&(c["a"].send({tag:"tempInteractionTest",content:{msg:"清空互动容器，由".concat(t,"触发清空，清空").concat(this.dom.children[0].className)}}),this.dom.innerHTML=""),this.vm=this.initVm(this.app),this.render(this.dom,this.vm)}},{key:"initVm",value:function(t){var e=s.a.extend(t),o=this.createPropsData(),n=new e({i18n:r["b"],propsData:o,store:this.store||{}});return n.$mount(),n}},{key:"render",value:function(t,e){t.appendChild(e.$el)}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.submit,o=t.key,n=void 0===o?"":o;if(this.vm){var i,a;if(e&&this.vm.submit(),this.vm.$destroy(),"classRest"===n)null===this||void 0===this||null===(i=this.dom)||void 0===i||i.removeChild(null===this||void 0===this||null===(a=this.vm)||void 0===a?void 0:a.$el);else this.dom.innerHTML="";this.vm=null,this.app=null}}},{key:"getProperties",value:function(t,e){return t["".concat(e)].properties}},{key:"handleMsg",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log(t)}}]),t}()},c17f:function(t,e,o){},c6a1:function(t,e,o){"use strict";o("a6e8")},dad2:function(t,e,o){"use strict";o.d(e,"a",(function(){return d}));var n=o("c7eb"),i=o("1da1"),a=o("d4ec"),s=o("bee2"),r=o("262e"),c=o("2caf"),l=(o("b64b"),o("99af"),o("8bbf"),o("753a")),A=o("c5f1"),d=function(t){Object(r["a"])(o,t);var e=Object(c["a"])(o);function o(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return console.info("函数申明 Main(opts)",n,"filePath:renderer/components/Classroom/CommonInteractions/photoWall/photoWall.js"),Object(a["a"])(this,o),t=e.call(this),t.options=n,t.tipTimer=null,t}return Object(s["a"])(o,[{key:"clearTipTimer",value:function(){this.tipTimer&&(clearTimeout(this.tipTimer),this.tipTimer=null)}},{key:"closeTip",value:function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(t&&(this.clearTipTimer(),e>0))var i=setTimeout((function(){var e,a;null!==t&&void 0!==t&&t.parentNode&&n&&(null===t||void 0===t||null===(a=t.parentNode)||void 0===a||a.classList.remove(n));null===t||void 0===t||null===(e=t.parentNode)||void 0===e||e.removeChild(t),clearTimeout(i),i=null,o&&o()}),e)}},{key:"showShortCutTip",value:function(t){var e=t.duration,o=void 0===e?3e3:e,n=t.tips,i=JSON.parse(window.sessionStorage.getItem("photoWallShortCutTip"));if(!i){var a=document.createElement("div");a.setAttribute("class","shortCutTip animateTada"),a.innerHTML="\n      <p>".concat(n,"</p>\n    "),document.getElementById("photoWallContainer").appendChild(a),window.sessionStorage.setItem("photoWallShortCutTip",!0),this.closeTip(a,o)}}},{key:"showNotjoinTip",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.tips,n=e.callback,i=e.className,a=void 0===i?null:i,s=e.duration,r=void 0===s?3e3:s,c=e.dom,l=void 0===c?"photoWallContainer":c,A=document.createElement("div");A.setAttribute("class","notJoinTip ".concat(a||"")),A.innerHTML="\n      <p>".concat(o,"</p>\n    "),null===(t=document.getElementById(l))||void 0===t||t.appendChild(A),this.closeTip(A,r,n)}},{key:"showCoinsTip",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.tips,n=e.coins,i=void 0===n?0:n,a=e.duration,s=void 0===a?3200:a,r=e.callback,c=void 0===r?null:r,l=e.dom,A=void 0===l?"photoWallContainer":l,d=e.maskClass,h=void 0===d?"photoWallContainer-mask":d,u=e.tipClass,m=void 0===u?"":u,p=document.getElementById("submitTipContainer");p&&p.parentNode.removeChild(p);var f,g=document.createElement("div");(g.setAttribute("class","wallConisTip animateTada-new ".concat(m)),g.innerHTML='\n      <div class="title">\n        <div class="bg-img"></div>\n        <p>'.concat(o,"</p>\n      </div>\n    "),i&&(g.innerHTML+='<div class="coins">\n        <i></i> +'.concat(i,"\n      </div>")),h&&document.getElementById(A))&&(null===(f=document.getElementById(A))||void 0===f||null===(f=f.classList)||void 0===f||f.add(h));null===(t=document.getElementById(A))||void 0===t||t.appendChild(g),this.closeTip(g,s,c,h)}},{key:"showSubmitTip",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.duration,n=void 0===o?3e3:o,i=e.callback,a=void 0===i?null:i,s=e.text,r=e.icon,c=e.dom,l=void 0===c?"photoWallContainer":c,A="loading"===r?0:n,d=document.getElementById("submitTipContainer");d&&d.parentNode.removeChild(d);var h=document.createElement("div");h.setAttribute("id","submitTipContainer"),h.setAttribute("class","submitTipContainer"),h.innerHTML='\n      <div class="tipContainer">\n        '.concat(r?'<i class="'+r+'"></i>':"","\n        <p>").concat(s,"</p>\n      </div>\n    "),null===(t=document.getElementById(l))||void 0===t||t.appendChild(h),this.closeTip(h,A,a)}},{key:"initCountdownTime",value:function(){var t=+new Date,e=this.options.roomMessage.roomInfo.commonOption.timeOffset,o=1e3*this.options.ircMsg.totalTime-(t+e-this.options.ircMsg.beginTime);return o}},{key:"interactOpen",value:function(){var t=Object(i["a"])(Object(n["a"])().mark((function t(){var e;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={planId:1*this.options.roomMessage.roomInfo.stuLiveInfo.planId,classId:1*this.options.roomMessage.roomInfo.stuLiveInfo.classId,interactId:this.options.ircMsg.interactId},t.next=3,Object(A["b"])(e);case 3:case"end":return t.stop()}}),t,this)})));function e(){return console.info("函数申明 interactOpen, filePath:renderer/components/Classroom/CommonInteractions/photoWall/photoWall.js"),t.apply(this,arguments)}return e}()},{key:"submitPhoto",value:function(){var t=Object(i["a"])(Object(n["a"])().mark((function t(e){var o,i;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o={planId:1*this.options.roomMessage.roomInfo.stuLiveInfo.planId,classId:this.options.roomMessage.roomInfo.stuLiveInfo.classId,tutorId:this.options.roomMessage.roomInfo.stuLiveInfo.tutorId,photoPath:e,interactId:this.options.ircMsg.interactId,teacherId:this.options.roomMessage.roomInfo.teacherInfo.id,version:0},t.next=3,Object(A["d"])(o);case 3:return i=t.sent,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return console.info("函数申明 submitPhoto(_x)",e,"filePath:renderer/components/Classroom/CommonInteractions/photoWall/photoWall.js"),t.apply(this,arguments)}return e}()},{key:"getWallStatus",value:function(){var t=Object(i["a"])(Object(n["a"])().mark((function t(){var e,o;return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e={planId:1*this.options.roomMessage.roomInfo.stuLiveInfo.planId,interactId:this.options.ircMsg.interactId},t.next=3,Object(A["a"])(e);case 3:return o=t.sent,t.abrupt("return",o);case 5:case"end":return t.stop()}}),t,this)})));function e(){return console.info("函数申明 getWallStatus, filePath:renderer/components/Classroom/CommonInteractions/photoWall/photoWall.js"),t.apply(this,arguments)}return e}()}]),o}(l["a"])},e28a:function(t,e){t.exports="data:audio/mpeg;base64,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JH6uGXWdXXUN9OwC3Oky8oEGZgsqZXyZgB23ygVgWFPMbh6XQE3EKqUIgb/jMZxsTtLvLu7lqU40/51aTdnuNb+1BJFEj0Emo7cg6iU+smxspErYsBLLJBXi2KTNw0uaflJWjhxMkRh0iYY8jOyjSaREiiXJL68yx1N3l/UwDSSLya2dBQCR3G5NGnzTQWUXrXi0DjkmlN4ydTY3sXehAdT2UnX1u0Eq6daBb+uVVUhJfVqlAZAAKXL0mI2cCKTjDGhqlhO4ZiuW86WajU9KW7JjQNllTZZbpcKaN+Ua+1El8VVjVV2qrDuGUofG5sGPal1VL/aHVLWN/qqgJQa1FZENYlcTbOrUBZYs/JFZ4JHqw0RU9QdE35Hlqjst//uQwPSAGMmjM8e8zaK+tKUw/Bm8DcsDX/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////uQwP+AMXz9GSVka4AAACXAAAAE//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//uQwP+AMYABLgAAACAAACXAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVEFHc2Z4X3BvcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAyMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf8="},e811:function(t,e,o){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"photoShotContainer"},[e("div",{staticClass:"cameraContainer",attrs:{id:"cameraContainer","data-log":"相机视频区"}},[e("img",{ref:"previewDom",staticClass:"previewDom",attrs:{id:"previewDom"}}),e("div",{staticClass:"cameraGrid"}),e("div",{ref:"photoShotVideo",style:{width:t.curWidth+"px"},attrs:{id:"photoShotVideo"}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showPhotoShotControl&&!t.isPhotoShot,expression:"showPhotoShotControl && !isPhotoShot"}],staticClass:"photoShotControl",attrs:{id:"photoShotControl","data-log":"拍照控制区"}},[e("div",{staticStyle:{width:"40%","text-align":"right"}},[t.deviceLists.length?e("div",{staticClass:"changeCameraDropdown",attrs:{"data-log":"摄像头列表"}},[e("a",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:function(){return t.showLists=!1},expression:"() => (showLists = false)"}],staticClass:"ant-dropdown-link",attrs:{href:"javascript:;"},on:{click:t.toggleLists}},[e("i",{staticClass:"changeCameraIcon"}),t._v(" "+t._s(t.deviceName)+" "),e("a-icon",{attrs:{type:"caret-up"}})],1),t.showLists?e("div",{staticClass:"ant-dropdown"},[e("ul",{staticClass:"ant-dropdown-menu"},t._l(t.deviceLists,(function(o){return e("li",{key:o.deviceId,staticClass:"ant-dropdown-menu-item",on:{click:function(e){return t.changeCameraId(o.deviceId,o.label)}}},[e("a",{attrs:{href:"javascript:;"}},[t._v(t._s(o.label))])])})),0)]):t._e()]):t._e()]),e("div",{ref:"takePhotoControl",staticStyle:{width:"33.33%"}},[e("div",{staticClass:"photoShotBtn",attrs:{"data-log":"拍照按钮"},on:{click:t.photoShot}},[e("i")])]),e("div",{staticClass:"graffitiBtn",attrs:{"data-log":"拍照上墙中的涂鸦画板"}},[t._v(" "+t._s(t.$t("classroom.interactions.photoWall.graffitiBtnName"))+" "),e("i",{on:{click:t.goGraffiti}}),e("span",[t._v(" "+t._s(t.$t("classroom.interactions.photoWall.graffitiDesc")[0])),e("br"),t._v(" "+t._s(t.$t("classroom.interactions.photoWall.graffitiDesc")[1])+" ")])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isPhotoShot,expression:"isPhotoShot"}],staticClass:"submitControl"},[e("div",{staticClass:"retryPhotoShot",on:{click:t.retryPhotoShot}},[e("i"),t._v(t._s(t.$t("common.retry")))]),e("div",{staticClass:"submit",on:{click:t.submit}},[e("i"),t._v(t._s(t.$t("common.submit")))])]),e("audio",{ref:"photoWallBtnSound",staticClass:"hide",attrs:{src:o("e28a")}})])},i=[],a=o("5530"),s=o("c7eb"),r=o("1da1"),c=(o("14d9"),o("b7ef"),o("907a"),o("986a"),o("1d02"),o("3c5d"),o("6ce5"),o("2834"),o("4ea1"),o("a9e3"),o("4de4"),o("d3b7"),o("159b"),o("c19f"),o("ace4"),o("e260"),o("5cc6"),o("9a8c"),o("a975"),o("735e"),o("c1ac"),o("d139"),o("3a7b"),o("d5d6"),o("82f8"),o("e91f"),o("60bd"),o("5f96"),o("3280"),o("3fcc"),o("ca91"),o("25a1"),o("cd26"),o("2954"),o("649e"),o("219c"),o("170b"),o("b39a"),o("72f7"),o("a5d8")),l=o("e417"),A=o("d0db"),d=o("6543"),h=o("e39c"),u=o("e177"),m=o("b047"),p=o.n(m),f={name:"photoShotCamera",props:{delay:{type:Number,default:0},options:{type:Object,default:function(){return{}}}},data:function(){return{deviceLists:[],deviceName:null,isPhotoShot:!1,showPhotoShotControl:!1,showLists:!1,rtcEngine:null,localDisplayVideoStatus:!0,curWidth:960,highEncoderConfig:{width:960,height:720,bitrate:910,frameRate:15},lowEncoderConfig:{bitrate:80,frameRate:10,width:160,height:120}}},directives:{Clickoutside:c["a"]},mounted:function(){var t=this;window.addEventListener("resize",this.resetWidth),this.$bus.$emit("getLocalDisplayVideoStatus",(function(e){t.localDisplayVideoStatus=e,e&&t.$bus.$emit("cameraStatus",!0)})),this.$nextTick(Object(r["a"])(Object(s["a"])().mark((function e(){var o,n,i,a,r,c,l;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.rtcEngine=(null===(o=window.RTC_COMMON)||void 0===o?void 0:o.rtcEngine)||(null===(n=t.thinkClass)||void 0===n||null===(n=n.RtcService)||void 0===n?void 0:n.rtcEngine),t.rtcService=(null===(i=window.RTC_COMMON)||void 0===i?void 0:i.classRtcChannel)||(null===(a=t.thinkClass)||void 0===a?void 0:a.RtcService),t.deviceLists=t.loadDeviceList(),e.next=5,Object(d["a"])();case 5:c=e.sent,l=t.deviceLists.filter((function(t){return t.deviceId===c})),null!==(r=l[0])&&void 0!==r&&r.label?t.deviceName=l[0].label:t.deviceName=t.deviceLists.length&&t.deviceLists[0]["label"].substring(0,16),t.resetWidth(),t.showPhotoShotControl=!0,t.rtcService.setVideoEncoderConfiguration(t.highEncoderConfig),t.rtcEngine.setupLocalVideo(document.getElementById("photoShotVideo"));case 12:case"end":return e.stop()}}),e)}))))},methods:{resetWidth:p()((function(){var t=this;this.$nextTick((function(){var e=document.querySelector("#photoShotVideo");e.clientHeight&&(t.curWidth=4*e.clientHeight/3)}))}),300,{leading:!0}),loadDeviceList:function(){var t,e=(null===(t=this.rtcEngine)||void 0===t?void 0:t.getVideoDevices())||[],o=[];return e.forEach((function(t){o.push({label:t.devicename,deviceId:t.deviceid})})),o},reSensorEvent:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(l["e"])(t,this.options.roomMessage.roomInfo.commonOption,Object(a["a"])({interact_id:this.options.ircMsg.interactId},e))},toggleLists:function(){this.showLists=!0,this.reSensorEvent("hw_classroom_interact_photograph_control",{control_type:"切换摄像头"}),A["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"点击打开摄像头列表"}})},base64ToBlob:function(t,e){for(var o=window.atob(t.split(",")[1]),n=new ArrayBuffer(o.length),i=new Uint8Array(n),a=0;a<o.length;a++)i[a]=o.charCodeAt(a);return new Blob([n],{type:e})},photoShot:p()((function(){var t=this;this.$refs.photoWallBtnSound.play(),this.reSensorEvent("hw_classroom_interact_photograph_control",{control_type:"拍照"});try{var e=document.querySelector("#photoShotVideo"),o=e.clientWidth,n=e.clientHeight,i=document.createElement("canvas");i.width=o,i.height=n;var a=document.querySelector("#photoShotVideo canvas"),s=i.getContext("2d");s.drawImage(a,0,0,o,n);var r=i.toDataURL("image/jpeg",1);this.$refs.previewDom.src=r,this.$refs.previewDom.style.width="100%",this.$refs.previewDom.style.height="100%";var c=Number(Object(h["r"])("imageCompressionFactor","configValue"))||.75;Object(u["c"])(r,1440,c).then((function(e){var o=t.base64ToBlob(e,"image/jpeg");t.$emit("photoData",{base64:r,blob:o}),t.isPhotoShot=!0,A["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"点击拍照",blob:o,base64:r.substring(r.indexOf(",")+1).length}})}))}catch(l){A["a"].send({tag:"student.Interact",level:"error",content:{interactType:"Wall",msg:"点击拍照报错",err:l}})}}),300),retryPhotoShot:function(){var t=this;return Object(r["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:A["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"点击重拍按钮"}}),t.$refs.photoWallBtnSound.play(),t.$refs.previewDom.src="",t.$refs.previewDom.style.width="",t.$refs.previewDom.style.height="",t.isPhotoShot=!1;case 6:case"end":return e.stop()}}),e)})))()},changeCameraId:function(t,e){t&&e&&(this.deviceName=e.substring(0,16),this.$bus.$emit("setDefaultVideoDevice",t),Object(d["e"])(t),A["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"点击切换摄像头"}}))},goGraffiti:function(){this.$refs.photoShotVideo.innerHTML="",this.$emit("changeTakePhotoWay","graffiti"),this.reSensorEvent("hw_classroom_interact_photograph_control",{control_type:"涂鸦板"}),A["a"].send({tag:"student.Interact",content:{interactType:"Wall",msg:"点击切换到涂鸦画板"}})},submit:function(){this.$refs.photoWallBtnSound.play(),this.$emit("submit"),this.reSensorEvent("hw_classroom_interact_photograph_submit",{submit_type:1})}},beforeDestroy:function(){this.rtcService.setVideoEncoderConfiguration(this.lowEncoderConfig),this.localDisplayVideoStatus&&(this.$bus.$emit("cameraStatus",!1),this.rtcEngine.setupLocalVideo(document.getElementById("video-group-local"))),window.removeEventListener("resize",this.resetWidth),this.$refs.photoShotVideo.innerHTML=""}},g=f,v=(o("5cbb"),o("2877")),b=Object(v["a"])(g,n,i,!1,null,"004f1016",null);e["a"]=b.exports},ed57:function(t,e,o){},f5b3:function(t,e,o){t.exports=o.p+"static/media/coin-fly.46908c84.mp3"},f839:function(t,e,o){"use strict";o("73cb")}}]);
//# sourceMappingURL=chunk-5db599bc.4bca80aa.js.map